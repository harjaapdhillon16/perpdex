"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fharjaapdhillon%2FDesktop%2Fperpdex%2Fapp%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fharjaapdhillon%2FDesktop%2Fperpdex%2Fapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fharjaapdhillon%2FDesktop%2Fperpdex%2Fapp%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fharjaapdhillon%2FDesktop%2Fperpdex%2Fapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_harjaapdhillon_Desktop_perpdex_app_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/harjaapdhillon/Desktop/perpdex/app/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_harjaapdhillon_Desktop_perpdex_app_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4yLjVfQGJhYmVsK2NvcmVANy4yOC42X3JlYWN0LWRvbUAxOC4zLjFfcmVhY3RAMTguMy4xX19yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGY2hhdCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY2hhdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmNoYXQlMkZyb3V0ZS50cyZhcHBEaXI9JTJGVXNlcnMlMkZoYXJqYWFwZGhpbGxvbiUyRkRlc2t0b3AlMkZwZXJwZGV4JTJGYXBwJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmhhcmphYXBkaGlsbG9uJTJGRGVza3RvcCUyRnBlcnBkZXglMkZhcHAmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2U7QUFDNUY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZXJwZGV4LWFwcC8/ZjFlZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvaGFyamFhcGRoaWxsb24vRGVza3RvcC9wZXJwZGV4L2FwcC9hcHAvYXBpL2NoYXQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2hhcmphYXBkaGlsbG9uL0Rlc2t0b3AvcGVycGRleC9hcHAvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jaGF0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fharjaapdhillon%2FDesktop%2Fperpdex%2Fapp%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fharjaapdhillon%2FDesktop%2Fperpdex%2Fapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/api/server.js\");\n\nconst DEFAULT_MODEL = \"deepseek-chat\";\nconst DEFAULT_URL = \"https://api.deepseek.com/v1/chat/completions\";\nfunction detectMarket(message) {\n    const lower = message.toLowerCase();\n    if (lower.includes(\"eth\")) return \"ETH\";\n    if (lower.includes(\"sol\")) return \"SOL\";\n    return null;\n}\nfunction parseNumber(value) {\n    const cleaned = value.replace(/,/g, \"\");\n    const parsed = Number(cleaned);\n    return Number.isFinite(parsed) ? parsed : null;\n}\nfunction parseLeverage(message) {\n    const match = message.match(/(\\d+(?:\\.\\d+)?)\\s*x/i);\n    if (!match) return null;\n    return parseNumber(match[1]);\n}\nfunction parseMargin(message) {\n    const usdMatch = message.match(/\\$\\s*([\\d,.]+)/);\n    if (usdMatch) {\n        const marginUsd = parseNumber(usdMatch[1]);\n        return marginUsd ? {\n            marginUsd\n        } : null;\n    }\n    const solMatch = message.match(/([\\d,.]+)\\s*sol/i);\n    if (solMatch) {\n        const marginSol = parseNumber(solMatch[1]);\n        return marginSol ? {\n            marginSol\n        } : null;\n    }\n    const generic = message.match(/with\\s+([\\d,.]+)/i);\n    if (generic) {\n        const marginSol = parseNumber(generic[1]);\n        return marginSol ? {\n            marginSol\n        } : null;\n    }\n    return null;\n}\nfunction parseSide(message) {\n    const lower = message.toLowerCase();\n    if (lower.includes(\"short\")) return \"short\";\n    if (lower.includes(\"long\")) return \"long\";\n    return null;\n}\nfunction parseIntent(message, hasWallet) {\n    const lower = message.toLowerCase();\n    const market = detectMarket(message) ?? \"SOL\";\n    if (lower.includes(\"close\")) {\n        if (!hasWallet) {\n            return {\n                intent: \"close_position\",\n                explanation: \"Connect a wallet so I can prepare the close transaction.\",\n                requiresConfirmation: false,\n                transaction: null\n            };\n        }\n        return {\n            intent: \"close_position\",\n            explanation: `I can close your ${market} position. Confirm to proceed.`,\n            requiresConfirmation: true,\n            transaction: {\n                type: \"close_position\",\n                market\n            }\n        };\n    }\n    if (lower.includes(\"open\")) {\n        const side = parseSide(message);\n        const leverage = parseLeverage(message);\n        const margin = parseMargin(message);\n        if (!hasWallet) {\n            return {\n                intent: \"open_position\",\n                explanation: \"Connect a wallet to open a position.\",\n                requiresConfirmation: false,\n                transaction: null\n            };\n        }\n        if (!side || !leverage || !margin) {\n            return {\n                intent: \"open_position\",\n                explanation: \"Share the side, leverage (e.g. 5x), and margin amount so I can prepare the trade.\",\n                requiresConfirmation: false,\n                transaction: null\n            };\n        }\n        return {\n            intent: \"open_position\",\n            explanation: `Opening a ${leverage}x ${side} ${market} position. Confirm to proceed.`,\n            requiresConfirmation: true,\n            transaction: {\n                type: \"open_position\",\n                market,\n                side,\n                leverage,\n                ...margin\n            }\n        };\n    }\n    if (lower.includes(\"position\")) {\n        return {\n            intent: \"show_positions\",\n            explanation: \"Fetching your open positions now.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    if (lower.includes(\"liquidation\")) {\n        return {\n            intent: \"show_liquidation\",\n            explanation: \"Liquidation prices use current oracle data and your margin.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    if (lower.includes(\"pnl\")) {\n        return {\n            intent: \"show_pnl\",\n            explanation: \"PnL is calculated from oracle prices and your entry.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    if (lower.includes(\"risk\")) {\n        return {\n            intent: \"risk_check\",\n            explanation: \"Risk is based on distance to liquidation. Connect a wallet to inspect positions.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    return null;\n}\nfunction fallbackResponse(message, hasWallet) {\n    const lower = message.toLowerCase();\n    const market = detectMarket(message);\n    if (lower.includes(\"close\")) {\n        if (!hasWallet) {\n            return {\n                intent: \"close_position\",\n                explanation: \"Connect a wallet so I can prepare the close transaction.\",\n                requiresConfirmation: false,\n                transaction: null\n            };\n        }\n        return {\n            intent: \"close_position\",\n            explanation: `I can close your ${market ?? \"open\"} position. Confirm to proceed.`,\n            requiresConfirmation: true,\n            transaction: {\n                type: \"close_position\",\n                market\n            }\n        };\n    }\n    if (lower.includes(\"open\")) {\n        if (!hasWallet) {\n            return {\n                intent: \"open_position\",\n                explanation: \"Connect a wallet to open a position.\",\n                requiresConfirmation: false,\n                transaction: null\n            };\n        }\n        return {\n            intent: \"open_position\",\n            explanation: \"Tell me the market, side, leverage, and margin so I can prepare the trade.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    if (lower.includes(\"liquidation\")) {\n        return {\n            intent: \"show_liquidation\",\n            explanation: \"I can calculate liquidation prices once your positions are loaded from chain.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    if (lower.includes(\"pnl\")) {\n        return {\n            intent: \"show_pnl\",\n            explanation: \"PnL is calculated from oracle prices and your entry.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    if (lower.includes(\"position\")) {\n        return {\n            intent: \"show_positions\",\n            explanation: \"Fetching your open positions now.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    if (lower.includes(\"risk\")) {\n        return {\n            intent: \"risk_check\",\n            explanation: \"Risk is based on distance to liquidation. Connect a wallet to inspect positions.\",\n            requiresConfirmation: false,\n            transaction: null\n        };\n    }\n    return {\n        intent: null,\n        explanation: \"Ask about positions, risk, or a trade action.\",\n        requiresConfirmation: false,\n        transaction: null\n    };\n}\nfunction extractJson(content) {\n    const trimmed = content.trim();\n    if (!trimmed) return null;\n    const withoutFence = trimmed.replace(/```json|```/g, \"\").trim();\n    const start = withoutFence.indexOf(\"{\");\n    const end = withoutFence.lastIndexOf(\"}\");\n    if (start === -1 || end === -1 || end <= start) return null;\n    const slice = withoutFence.slice(start, end + 1);\n    try {\n        return JSON.parse(slice);\n    } catch  {\n        return null;\n    }\n}\nasync function POST(request) {\n    let requestMessage = \"\";\n    let hasWallet = false;\n    try {\n        const body = await request.json();\n        const message = String(body?.message ?? \"\").trim();\n        const wallet = typeof body?.wallet === \"string\" ? body.wallet : null;\n        requestMessage = message;\n        hasWallet = Boolean(wallet);\n        if (!message) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"message is required\"\n            }, {\n                status: 400\n            });\n        }\n        const parsed = parseIntent(message, hasWallet);\n        if (parsed) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(parsed);\n        }\n        const apiKey = process.env.DEEPSEEK_API_KEY;\n        if (!apiKey) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(fallbackResponse(message, hasWallet));\n        }\n        const systemPrompt = [\n            \"You are a Solana perp DEX assistant.\",\n            \"Return only JSON with keys: intent, explanation, requiresConfirmation, transaction.\",\n            \"If wallet is missing, set requiresConfirmation=false and ask to connect.\",\n            \"Supported markets: ETH, SOL.\",\n            `Wallet: ${wallet ?? \"none\"}.`\n        ].join(\" \");\n        const response = await fetch(process.env.DEEPSEEK_API_URL ?? DEFAULT_URL, {\n            method: \"POST\",\n            headers: {\n                Authorization: `Bearer ${apiKey}`,\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                model: process.env.DEEPSEEK_MODEL ?? DEFAULT_MODEL,\n                temperature: 0.2,\n                max_tokens: 220,\n                messages: [\n                    {\n                        role: \"system\",\n                        content: systemPrompt\n                    },\n                    {\n                        role: \"user\",\n                        content: message\n                    }\n                ]\n            })\n        });\n        const data = await response.json();\n        if (!response.ok) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(fallbackResponse(message, hasWallet));\n        }\n        const content = data?.choices?.[0]?.message?.content ?? \"\";\n        const parsedJson = extractJson(content);\n        if (!parsedJson) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(fallbackResponse(message, hasWallet));\n        }\n        const result = {\n            intent: typeof parsedJson.intent === \"string\" ? parsedJson.intent : null,\n            explanation: typeof parsedJson.explanation === \"string\" ? parsedJson.explanation : \"I can help with positions, risk, and trade actions.\",\n            requiresConfirmation: Boolean(parsedJson.requiresConfirmation),\n            transaction: parsedJson.transaction && typeof parsedJson.transaction === \"object\" ? parsedJson.transaction : null\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        if (requestMessage) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(fallbackResponse(requestMessage, hasWallet));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            intent: null,\n            explanation: \"Chat is temporarily unavailable. Try again in a moment.\",\n            requiresConfirmation: false,\n            transaction: null\n        }, {\n            status: 200\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T3pCLE9BQU87UUFDZCxJQUFJTixnQkFBZ0I7WUFDbEIsT0FBT2xELHFEQUFZQSxDQUFDb0QsSUFBSSxDQUFDakIsaUJBQWlCZSxnQkFBZ0J6QjtRQUM1RDtRQUNBLE9BQU96QixxREFBWUEsQ0FBQ29ELElBQUksQ0FDdEI7WUFDRXpCLFFBQVE7WUFDUkMsYUFBYTtZQUNiQyxzQkFBc0I7WUFDdEJDLGFBQWE7UUFDZixHQUNBO1lBQUUyQixRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BlcnBkZXgtYXBwLy4vYXBwL2FwaS9jaGF0L3JvdXRlLnRzP2RlNDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5cbmNvbnN0IERFRkFVTFRfTU9ERUwgPSBcImRlZXBzZWVrLWNoYXRcIjtcbmNvbnN0IERFRkFVTFRfVVJMID0gXCJodHRwczovL2FwaS5kZWVwc2Vlay5jb20vdjEvY2hhdC9jb21wbGV0aW9uc1wiO1xuXG50eXBlIENoYXRSZXN1bHQgPSB7XG4gIGludGVudDogc3RyaW5nIHwgbnVsbDtcbiAgZXhwbGFuYXRpb246IHN0cmluZztcbiAgcmVxdWlyZXNDb25maXJtYXRpb246IGJvb2xlYW47XG4gIHRyYW5zYWN0aW9uOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGw7XG59O1xuXG5mdW5jdGlvbiBkZXRlY3RNYXJrZXQobWVzc2FnZTogc3RyaW5nKSB7XG4gIGNvbnN0IGxvd2VyID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJldGhcIikpIHJldHVybiBcIkVUSFwiO1xuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJzb2xcIikpIHJldHVybiBcIlNPTFwiO1xuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gcGFyc2VOdW1iZXIodmFsdWU6IHN0cmluZykge1xuICBjb25zdCBjbGVhbmVkID0gdmFsdWUucmVwbGFjZSgvLC9nLCBcIlwiKTtcbiAgY29uc3QgcGFyc2VkID0gTnVtYmVyKGNsZWFuZWQpO1xuICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKHBhcnNlZCkgPyBwYXJzZWQgOiBudWxsO1xufVxuXG5mdW5jdGlvbiBwYXJzZUxldmVyYWdlKG1lc3NhZ2U6IHN0cmluZykge1xuICBjb25zdCBtYXRjaCA9IG1lc3NhZ2UubWF0Y2goLyhcXGQrKD86XFwuXFxkKyk/KVxccyp4L2kpO1xuICBpZiAoIW1hdGNoKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIHBhcnNlTnVtYmVyKG1hdGNoWzFdKTtcbn1cblxuZnVuY3Rpb24gcGFyc2VNYXJnaW4obWVzc2FnZTogc3RyaW5nKSB7XG4gIGNvbnN0IHVzZE1hdGNoID0gbWVzc2FnZS5tYXRjaCgvXFwkXFxzKihbXFxkLC5dKykvKTtcbiAgaWYgKHVzZE1hdGNoKSB7XG4gICAgY29uc3QgbWFyZ2luVXNkID0gcGFyc2VOdW1iZXIodXNkTWF0Y2hbMV0pO1xuICAgIHJldHVybiBtYXJnaW5Vc2QgPyB7IG1hcmdpblVzZCB9IDogbnVsbDtcbiAgfVxuXG4gIGNvbnN0IHNvbE1hdGNoID0gbWVzc2FnZS5tYXRjaCgvKFtcXGQsLl0rKVxccypzb2wvaSk7XG4gIGlmIChzb2xNYXRjaCkge1xuICAgIGNvbnN0IG1hcmdpblNvbCA9IHBhcnNlTnVtYmVyKHNvbE1hdGNoWzFdKTtcbiAgICByZXR1cm4gbWFyZ2luU29sID8geyBtYXJnaW5Tb2wgfSA6IG51bGw7XG4gIH1cblxuICBjb25zdCBnZW5lcmljID0gbWVzc2FnZS5tYXRjaCgvd2l0aFxccysoW1xcZCwuXSspL2kpO1xuICBpZiAoZ2VuZXJpYykge1xuICAgIGNvbnN0IG1hcmdpblNvbCA9IHBhcnNlTnVtYmVyKGdlbmVyaWNbMV0pO1xuICAgIHJldHVybiBtYXJnaW5Tb2wgPyB7IG1hcmdpblNvbCB9IDogbnVsbDtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBwYXJzZVNpZGUobWVzc2FnZTogc3RyaW5nKSB7XG4gIGNvbnN0IGxvd2VyID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJzaG9ydFwiKSkgcmV0dXJuIFwic2hvcnRcIjtcbiAgaWYgKGxvd2VyLmluY2x1ZGVzKFwibG9uZ1wiKSkgcmV0dXJuIFwibG9uZ1wiO1xuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gcGFyc2VJbnRlbnQobWVzc2FnZTogc3RyaW5nLCBoYXNXYWxsZXQ6IGJvb2xlYW4pOiBDaGF0UmVzdWx0IHwgbnVsbCB7XG4gIGNvbnN0IGxvd2VyID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBtYXJrZXQgPSBkZXRlY3RNYXJrZXQobWVzc2FnZSkgPz8gXCJTT0xcIjtcblxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJjbG9zZVwiKSkge1xuICAgIGlmICghaGFzV2FsbGV0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbnRlbnQ6IFwiY2xvc2VfcG9zaXRpb25cIixcbiAgICAgICAgZXhwbGFuYXRpb246IFwiQ29ubmVjdCBhIHdhbGxldCBzbyBJIGNhbiBwcmVwYXJlIHRoZSBjbG9zZSB0cmFuc2FjdGlvbi5cIixcbiAgICAgICAgcmVxdWlyZXNDb25maXJtYXRpb246IGZhbHNlLFxuICAgICAgICB0cmFuc2FjdGlvbjogbnVsbFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGludGVudDogXCJjbG9zZV9wb3NpdGlvblwiLFxuICAgICAgZXhwbGFuYXRpb246IGBJIGNhbiBjbG9zZSB5b3VyICR7bWFya2V0fSBwb3NpdGlvbi4gQ29uZmlybSB0byBwcm9jZWVkLmAsXG4gICAgICByZXF1aXJlc0NvbmZpcm1hdGlvbjogdHJ1ZSxcbiAgICAgIHRyYW5zYWN0aW9uOiB7IHR5cGU6IFwiY2xvc2VfcG9zaXRpb25cIiwgbWFya2V0IH1cbiAgICB9O1xuICB9XG5cbiAgaWYgKGxvd2VyLmluY2x1ZGVzKFwib3BlblwiKSkge1xuICAgIGNvbnN0IHNpZGUgPSBwYXJzZVNpZGUobWVzc2FnZSk7XG4gICAgY29uc3QgbGV2ZXJhZ2UgPSBwYXJzZUxldmVyYWdlKG1lc3NhZ2UpO1xuICAgIGNvbnN0IG1hcmdpbiA9IHBhcnNlTWFyZ2luKG1lc3NhZ2UpO1xuXG4gICAgaWYgKCFoYXNXYWxsZXQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGludGVudDogXCJvcGVuX3Bvc2l0aW9uXCIsXG4gICAgICAgIGV4cGxhbmF0aW9uOiBcIkNvbm5lY3QgYSB3YWxsZXQgdG8gb3BlbiBhIHBvc2l0aW9uLlwiLFxuICAgICAgICByZXF1aXJlc0NvbmZpcm1hdGlvbjogZmFsc2UsXG4gICAgICAgIHRyYW5zYWN0aW9uOiBudWxsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmICghc2lkZSB8fCAhbGV2ZXJhZ2UgfHwgIW1hcmdpbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaW50ZW50OiBcIm9wZW5fcG9zaXRpb25cIixcbiAgICAgICAgZXhwbGFuYXRpb246XG4gICAgICAgICAgXCJTaGFyZSB0aGUgc2lkZSwgbGV2ZXJhZ2UgKGUuZy4gNXgpLCBhbmQgbWFyZ2luIGFtb3VudCBzbyBJIGNhbiBwcmVwYXJlIHRoZSB0cmFkZS5cIixcbiAgICAgICAgcmVxdWlyZXNDb25maXJtYXRpb246IGZhbHNlLFxuICAgICAgICB0cmFuc2FjdGlvbjogbnVsbFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgaW50ZW50OiBcIm9wZW5fcG9zaXRpb25cIixcbiAgICAgIGV4cGxhbmF0aW9uOiBgT3BlbmluZyBhICR7bGV2ZXJhZ2V9eCAke3NpZGV9ICR7bWFya2V0fSBwb3NpdGlvbi4gQ29uZmlybSB0byBwcm9jZWVkLmAsXG4gICAgICByZXF1aXJlc0NvbmZpcm1hdGlvbjogdHJ1ZSxcbiAgICAgIHRyYW5zYWN0aW9uOiB7IHR5cGU6IFwib3Blbl9wb3NpdGlvblwiLCBtYXJrZXQsIHNpZGUsIGxldmVyYWdlLCAuLi5tYXJnaW4gfVxuICAgIH07XG4gIH1cblxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJwb3NpdGlvblwiKSkge1xuICAgIHJldHVybiB7XG4gICAgICBpbnRlbnQ6IFwic2hvd19wb3NpdGlvbnNcIixcbiAgICAgIGV4cGxhbmF0aW9uOiBcIkZldGNoaW5nIHlvdXIgb3BlbiBwb3NpdGlvbnMgbm93LlwiLFxuICAgICAgcmVxdWlyZXNDb25maXJtYXRpb246IGZhbHNlLFxuICAgICAgdHJhbnNhY3Rpb246IG51bGxcbiAgICB9O1xuICB9XG5cbiAgaWYgKGxvd2VyLmluY2x1ZGVzKFwibGlxdWlkYXRpb25cIikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaW50ZW50OiBcInNob3dfbGlxdWlkYXRpb25cIixcbiAgICAgIGV4cGxhbmF0aW9uOiBcIkxpcXVpZGF0aW9uIHByaWNlcyB1c2UgY3VycmVudCBvcmFjbGUgZGF0YSBhbmQgeW91ciBtYXJnaW4uXCIsXG4gICAgICByZXF1aXJlc0NvbmZpcm1hdGlvbjogZmFsc2UsXG4gICAgICB0cmFuc2FjdGlvbjogbnVsbFxuICAgIH07XG4gIH1cblxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJwbmxcIikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaW50ZW50OiBcInNob3dfcG5sXCIsXG4gICAgICBleHBsYW5hdGlvbjogXCJQbkwgaXMgY2FsY3VsYXRlZCBmcm9tIG9yYWNsZSBwcmljZXMgYW5kIHlvdXIgZW50cnkuXCIsXG4gICAgICByZXF1aXJlc0NvbmZpcm1hdGlvbjogZmFsc2UsXG4gICAgICB0cmFuc2FjdGlvbjogbnVsbFxuICAgIH07XG4gIH1cblxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJyaXNrXCIpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGludGVudDogXCJyaXNrX2NoZWNrXCIsXG4gICAgICBleHBsYW5hdGlvbjpcbiAgICAgICAgXCJSaXNrIGlzIGJhc2VkIG9uIGRpc3RhbmNlIHRvIGxpcXVpZGF0aW9uLiBDb25uZWN0IGEgd2FsbGV0IHRvIGluc3BlY3QgcG9zaXRpb25zLlwiLFxuICAgICAgcmVxdWlyZXNDb25maXJtYXRpb246IGZhbHNlLFxuICAgICAgdHJhbnNhY3Rpb246IG51bGxcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIGZhbGxiYWNrUmVzcG9uc2UobWVzc2FnZTogc3RyaW5nLCBoYXNXYWxsZXQ6IGJvb2xlYW4pOiBDaGF0UmVzdWx0IHtcbiAgY29uc3QgbG93ZXIgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IG1hcmtldCA9IGRldGVjdE1hcmtldChtZXNzYWdlKTtcblxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJjbG9zZVwiKSkge1xuICAgIGlmICghaGFzV2FsbGV0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbnRlbnQ6IFwiY2xvc2VfcG9zaXRpb25cIixcbiAgICAgICAgZXhwbGFuYXRpb246IFwiQ29ubmVjdCBhIHdhbGxldCBzbyBJIGNhbiBwcmVwYXJlIHRoZSBjbG9zZSB0cmFuc2FjdGlvbi5cIixcbiAgICAgICAgcmVxdWlyZXNDb25maXJtYXRpb246IGZhbHNlLFxuICAgICAgICB0cmFuc2FjdGlvbjogbnVsbFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGludGVudDogXCJjbG9zZV9wb3NpdGlvblwiLFxuICAgICAgZXhwbGFuYXRpb246IGBJIGNhbiBjbG9zZSB5b3VyICR7bWFya2V0ID8/IFwib3BlblwifSBwb3NpdGlvbi4gQ29uZmlybSB0byBwcm9jZWVkLmAsXG4gICAgICByZXF1aXJlc0NvbmZpcm1hdGlvbjogdHJ1ZSxcbiAgICAgIHRyYW5zYWN0aW9uOiB7IHR5cGU6IFwiY2xvc2VfcG9zaXRpb25cIiwgbWFya2V0IH1cbiAgICB9O1xuICB9XG5cbiAgaWYgKGxvd2VyLmluY2x1ZGVzKFwib3BlblwiKSkge1xuICAgIGlmICghaGFzV2FsbGV0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbnRlbnQ6IFwib3Blbl9wb3NpdGlvblwiLFxuICAgICAgICBleHBsYW5hdGlvbjogXCJDb25uZWN0IGEgd2FsbGV0IHRvIG9wZW4gYSBwb3NpdGlvbi5cIixcbiAgICAgICAgcmVxdWlyZXNDb25maXJtYXRpb246IGZhbHNlLFxuICAgICAgICB0cmFuc2FjdGlvbjogbnVsbFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGludGVudDogXCJvcGVuX3Bvc2l0aW9uXCIsXG4gICAgICBleHBsYW5hdGlvbjpcbiAgICAgICAgXCJUZWxsIG1lIHRoZSBtYXJrZXQsIHNpZGUsIGxldmVyYWdlLCBhbmQgbWFyZ2luIHNvIEkgY2FuIHByZXBhcmUgdGhlIHRyYWRlLlwiLFxuICAgICAgcmVxdWlyZXNDb25maXJtYXRpb246IGZhbHNlLFxuICAgICAgdHJhbnNhY3Rpb246IG51bGxcbiAgICB9O1xuICB9XG5cbiAgaWYgKGxvd2VyLmluY2x1ZGVzKFwibGlxdWlkYXRpb25cIikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaW50ZW50OiBcInNob3dfbGlxdWlkYXRpb25cIixcbiAgICAgIGV4cGxhbmF0aW9uOlxuICAgICAgICBcIkkgY2FuIGNhbGN1bGF0ZSBsaXF1aWRhdGlvbiBwcmljZXMgb25jZSB5b3VyIHBvc2l0aW9ucyBhcmUgbG9hZGVkIGZyb20gY2hhaW4uXCIsXG4gICAgICByZXF1aXJlc0NvbmZpcm1hdGlvbjogZmFsc2UsXG4gICAgICB0cmFuc2FjdGlvbjogbnVsbFxuICAgIH07XG4gIH1cblxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJwbmxcIikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaW50ZW50OiBcInNob3dfcG5sXCIsXG4gICAgICBleHBsYW5hdGlvbjogXCJQbkwgaXMgY2FsY3VsYXRlZCBmcm9tIG9yYWNsZSBwcmljZXMgYW5kIHlvdXIgZW50cnkuXCIsXG4gICAgICByZXF1aXJlc0NvbmZpcm1hdGlvbjogZmFsc2UsXG4gICAgICB0cmFuc2FjdGlvbjogbnVsbFxuICAgIH07XG4gIH1cblxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJwb3NpdGlvblwiKSkge1xuICAgIHJldHVybiB7XG4gICAgICBpbnRlbnQ6IFwic2hvd19wb3NpdGlvbnNcIixcbiAgICAgIGV4cGxhbmF0aW9uOiBcIkZldGNoaW5nIHlvdXIgb3BlbiBwb3NpdGlvbnMgbm93LlwiLFxuICAgICAgcmVxdWlyZXNDb25maXJtYXRpb246IGZhbHNlLFxuICAgICAgdHJhbnNhY3Rpb246IG51bGxcbiAgICB9O1xuICB9XG5cbiAgaWYgKGxvd2VyLmluY2x1ZGVzKFwicmlza1wiKSkge1xuICAgIHJldHVybiB7XG4gICAgICBpbnRlbnQ6IFwicmlza19jaGVja1wiLFxuICAgICAgZXhwbGFuYXRpb246XG4gICAgICAgIFwiUmlzayBpcyBiYXNlZCBvbiBkaXN0YW5jZSB0byBsaXF1aWRhdGlvbi4gQ29ubmVjdCBhIHdhbGxldCB0byBpbnNwZWN0IHBvc2l0aW9ucy5cIixcbiAgICAgIHJlcXVpcmVzQ29uZmlybWF0aW9uOiBmYWxzZSxcbiAgICAgIHRyYW5zYWN0aW9uOiBudWxsXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaW50ZW50OiBudWxsLFxuICAgIGV4cGxhbmF0aW9uOiBcIkFzayBhYm91dCBwb3NpdGlvbnMsIHJpc2ssIG9yIGEgdHJhZGUgYWN0aW9uLlwiLFxuICAgIHJlcXVpcmVzQ29uZmlybWF0aW9uOiBmYWxzZSxcbiAgICB0cmFuc2FjdGlvbjogbnVsbFxuICB9O1xufVxuXG5mdW5jdGlvbiBleHRyYWN0SnNvbihjb250ZW50OiBzdHJpbmcpIHtcbiAgY29uc3QgdHJpbW1lZCA9IGNvbnRlbnQudHJpbSgpO1xuICBpZiAoIXRyaW1tZWQpIHJldHVybiBudWxsO1xuICBjb25zdCB3aXRob3V0RmVuY2UgPSB0cmltbWVkLnJlcGxhY2UoL2BgYGpzb258YGBgL2csIFwiXCIpLnRyaW0oKTtcbiAgY29uc3Qgc3RhcnQgPSB3aXRob3V0RmVuY2UuaW5kZXhPZihcIntcIik7XG4gIGNvbnN0IGVuZCA9IHdpdGhvdXRGZW5jZS5sYXN0SW5kZXhPZihcIn1cIik7XG4gIGlmIChzdGFydCA9PT0gLTEgfHwgZW5kID09PSAtMSB8fCBlbmQgPD0gc3RhcnQpIHJldHVybiBudWxsO1xuICBjb25zdCBzbGljZSA9IHdpdGhvdXRGZW5jZS5zbGljZShzdGFydCwgZW5kICsgMSk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc2xpY2UpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIGxldCByZXF1ZXN0TWVzc2FnZSA9IFwiXCI7XG4gIGxldCBoYXNXYWxsZXQgPSBmYWxzZTtcblxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCBtZXNzYWdlID0gU3RyaW5nKGJvZHk/Lm1lc3NhZ2UgPz8gXCJcIikudHJpbSgpO1xuICAgIGNvbnN0IHdhbGxldCA9IHR5cGVvZiBib2R5Py53YWxsZXQgPT09IFwic3RyaW5nXCIgPyBib2R5LndhbGxldCA6IG51bGw7XG4gICAgcmVxdWVzdE1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIGhhc1dhbGxldCA9IEJvb2xlYW4od2FsbGV0KTtcblxuICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwibWVzc2FnZSBpcyByZXF1aXJlZFwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgcGFyc2VkID0gcGFyc2VJbnRlbnQobWVzc2FnZSwgaGFzV2FsbGV0KTtcbiAgICBpZiAocGFyc2VkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocGFyc2VkKTtcbiAgICB9XG5cbiAgICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5ERUVQU0VFS19BUElfS0VZO1xuICAgIGlmICghYXBpS2V5KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZmFsbGJhY2tSZXNwb25zZShtZXNzYWdlLCBoYXNXYWxsZXQpKTtcbiAgICB9XG5cbiAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBbXG4gICAgICBcIllvdSBhcmUgYSBTb2xhbmEgcGVycCBERVggYXNzaXN0YW50LlwiLFxuICAgICAgXCJSZXR1cm4gb25seSBKU09OIHdpdGgga2V5czogaW50ZW50LCBleHBsYW5hdGlvbiwgcmVxdWlyZXNDb25maXJtYXRpb24sIHRyYW5zYWN0aW9uLlwiLFxuICAgICAgXCJJZiB3YWxsZXQgaXMgbWlzc2luZywgc2V0IHJlcXVpcmVzQ29uZmlybWF0aW9uPWZhbHNlIGFuZCBhc2sgdG8gY29ubmVjdC5cIixcbiAgICAgIFwiU3VwcG9ydGVkIG1hcmtldHM6IEVUSCwgU09MLlwiLFxuICAgICAgYFdhbGxldDogJHt3YWxsZXQgPz8gXCJub25lXCJ9LmBcbiAgICBdLmpvaW4oXCIgXCIpO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChwcm9jZXNzLmVudi5ERUVQU0VFS19BUElfVVJMID8/IERFRkFVTFRfVVJMLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7YXBpS2V5fWAsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBtb2RlbDogcHJvY2Vzcy5lbnYuREVFUFNFRUtfTU9ERUwgPz8gREVGQVVMVF9NT0RFTCxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuMixcbiAgICAgICAgbWF4X3Rva2VuczogMjIwLFxuICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG4gICAgICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogbWVzc2FnZSB9XG4gICAgICAgIF1cbiAgICAgIH0pXG4gICAgfSk7XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihmYWxsYmFja1Jlc3BvbnNlKG1lc3NhZ2UsIGhhc1dhbGxldCkpO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbnRlbnQgPSBkYXRhPy5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgPz8gXCJcIjtcbiAgICBjb25zdCBwYXJzZWRKc29uID0gZXh0cmFjdEpzb24oY29udGVudCk7XG4gICAgaWYgKCFwYXJzZWRKc29uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZmFsbGJhY2tSZXNwb25zZShtZXNzYWdlLCBoYXNXYWxsZXQpKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQ6IENoYXRSZXN1bHQgPSB7XG4gICAgICBpbnRlbnQ6IHR5cGVvZiBwYXJzZWRKc29uLmludGVudCA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlZEpzb24uaW50ZW50IDogbnVsbCxcbiAgICAgIGV4cGxhbmF0aW9uOlxuICAgICAgICB0eXBlb2YgcGFyc2VkSnNvbi5leHBsYW5hdGlvbiA9PT0gXCJzdHJpbmdcIlxuICAgICAgICAgID8gcGFyc2VkSnNvbi5leHBsYW5hdGlvblxuICAgICAgICAgIDogXCJJIGNhbiBoZWxwIHdpdGggcG9zaXRpb25zLCByaXNrLCBhbmQgdHJhZGUgYWN0aW9ucy5cIixcbiAgICAgIHJlcXVpcmVzQ29uZmlybWF0aW9uOiBCb29sZWFuKHBhcnNlZEpzb24ucmVxdWlyZXNDb25maXJtYXRpb24pLFxuICAgICAgdHJhbnNhY3Rpb246XG4gICAgICAgIHBhcnNlZEpzb24udHJhbnNhY3Rpb24gJiYgdHlwZW9mIHBhcnNlZEpzb24udHJhbnNhY3Rpb24gPT09IFwib2JqZWN0XCJcbiAgICAgICAgICA/IHBhcnNlZEpzb24udHJhbnNhY3Rpb25cbiAgICAgICAgICA6IG51bGxcbiAgICB9O1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3VsdCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKHJlcXVlc3RNZXNzYWdlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZmFsbGJhY2tSZXNwb25zZShyZXF1ZXN0TWVzc2FnZSwgaGFzV2FsbGV0KSk7XG4gICAgfVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHtcbiAgICAgICAgaW50ZW50OiBudWxsLFxuICAgICAgICBleHBsYW5hdGlvbjogXCJDaGF0IGlzIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlLiBUcnkgYWdhaW4gaW4gYSBtb21lbnQuXCIsXG4gICAgICAgIHJlcXVpcmVzQ29uZmlybWF0aW9uOiBmYWxzZSxcbiAgICAgICAgdHJhbnNhY3Rpb246IG51bGxcbiAgICAgIH0sXG4gICAgICB7IHN0YXR1czogMjAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiREVGQVVMVF9NT0RFTCIsIkRFRkFVTFRfVVJMIiwiZGV0ZWN0TWFya2V0IiwibWVzc2FnZSIsImxvd2VyIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsInBhcnNlTnVtYmVyIiwidmFsdWUiLCJjbGVhbmVkIiwicmVwbGFjZSIsInBhcnNlZCIsIk51bWJlciIsImlzRmluaXRlIiwicGFyc2VMZXZlcmFnZSIsIm1hdGNoIiwicGFyc2VNYXJnaW4iLCJ1c2RNYXRjaCIsIm1hcmdpblVzZCIsInNvbE1hdGNoIiwibWFyZ2luU29sIiwiZ2VuZXJpYyIsInBhcnNlU2lkZSIsInBhcnNlSW50ZW50IiwiaGFzV2FsbGV0IiwibWFya2V0IiwiaW50ZW50IiwiZXhwbGFuYXRpb24iLCJyZXF1aXJlc0NvbmZpcm1hdGlvbiIsInRyYW5zYWN0aW9uIiwidHlwZSIsInNpZGUiLCJsZXZlcmFnZSIsIm1hcmdpbiIsImZhbGxiYWNrUmVzcG9uc2UiLCJleHRyYWN0SnNvbiIsImNvbnRlbnQiLCJ0cmltbWVkIiwidHJpbSIsIndpdGhvdXRGZW5jZSIsInN0YXJ0IiwiaW5kZXhPZiIsImVuZCIsImxhc3RJbmRleE9mIiwic2xpY2UiLCJKU09OIiwicGFyc2UiLCJQT1NUIiwicmVxdWVzdCIsInJlcXVlc3RNZXNzYWdlIiwiYm9keSIsImpzb24iLCJTdHJpbmciLCJ3YWxsZXQiLCJCb29sZWFuIiwiZXJyb3IiLCJzdGF0dXMiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiREVFUFNFRUtfQVBJX0tFWSIsInN5c3RlbVByb21wdCIsImpvaW4iLCJyZXNwb25zZSIsImZldGNoIiwiREVFUFNFRUtfQVBJX1VSTCIsIm1ldGhvZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwic3RyaW5naWZ5IiwibW9kZWwiLCJERUVQU0VFS19NT0RFTCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsIm1lc3NhZ2VzIiwicm9sZSIsImRhdGEiLCJvayIsImNob2ljZXMiLCJwYXJzZWRKc29uIiwicmVzdWx0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.2.5_@babel+core@7.28.6_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fharjaapdhillon%2FDesktop%2Fperpdex%2Fapp%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fharjaapdhillon%2FDesktop%2Fperpdex%2Fapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();